(self.webpackChunkpco_docs=self.webpackChunkpco_docs||[]).push([[122],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),c=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},s=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),s=c(n),m=i,k=s["".concat(p,".").concat(m)]||s[m]||u[m]||r;return n?a.createElement(k,l(l({ref:t},d),{},{components:n})):a.createElement(k,l({ref:t},d))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=s;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var c=2;c<r;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}s.displayName="MDXCreateElement"},1814:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return c},toc:function(){return d},default:function(){return s}});var a=n(2122),i=n(9756),r=(n(7294),n(3905)),l=["components"],o={title:"Android SDK"},p=void 0,c={unversionedId:"integrate/sdks/android",id:"integrate/sdks/android",isDocsHomePage:!1,title:"Android SDK",description:"View on GitHub",source:"@site/docs/1-integrate/2-sdks/2-android.md",sourceDirName:"1-integrate/2-sdks",slug:"/integrate/sdks/android",permalink:"/docs/integrate/sdks/android",version:"current",sidebarPosition:2,frontMatter:{title:"Android SDK"},sidebar:"docs",previous:{title:"iOS SDK",permalink:"/docs/integrate/sdks/ios"},next:{title:"Overview",permalink:"/docs/integrate/ecomm"}},d=[{value:"Before you start",id:"before-you-start",children:[{value:"Minimum Requirements",id:"minimum-requirements",children:[]}]},{value:"Setting up the SDK",id:"setting-up-the-sdk",children:[{value:"Required Permissions",id:"required-permissions",children:[]},{value:"Adding SafetyNet Support",id:"adding-safetynet-support",children:[]}]},{value:"Using the SDK",id:"using-the-sdk",children:[{value:"Sequence diagram",id:"sequence-diagram",children:[]},{value:"Server Checkout request",id:"server-checkout-request",children:[]},{value:"Initializing PointCheckoutClient",id:"initializing-pointcheckoutclient",children:[]},{value:"Create PointCheckoutClient",id:"create-pointcheckoutclient",children:[]},{value:"Initialize",id:"initialize-1",children:[]},{value:"Payment submit",id:"payment-submit-1",children:[]}]}],u={toc:d};function s(e){var t=e.components,o=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("a",{className:"button button--primary button--large",href:"http://www.github.com/pointcheckout/android-sdk"},"View on GitHub"),(0,r.kt)("h2",{id:"before-you-start"},"Before you start"),(0,r.kt)("h3",{id:"minimum-requirements"},"Minimum Requirements"),(0,r.kt)("p",null,"These are the minimum required steps to use the PointCheckout SDK in your Android app. We assume that you are using Android Studio for your Android development. The minimum supported Android API level for the SDK is 16 (KitKat), however, setting the minimum Android API level to 26 (Pie) is recommended."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The SDK uses Google's ",(0,r.kt)("a",{parentName:"p",href:"https://developer.android.com/training/safetynet/attestation"},"SafetyNet API")," for security, setting minimum Android API to lower than 26 will prevent it from functioning."))),(0,r.kt)("h2",{id:"setting-up-the-sdk"},"Setting up the SDK"),(0,r.kt)("p",null,"Add the SDK to your project:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add the following to ",(0,r.kt)("inlineCode",{parentName:"li"},"your_project_home/build.gradle"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"allprojects {\n  repositories {\n    ...\n    maven { url 'https://jitpack.io' }\n    flatDir {\n      dirs 'libs'\n    }\n  }\n}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add the following dependency to ",(0,r.kt)("inlineCode",{parentName:"li"},"your_project_home/app/build.gradle"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"dependencies {\n  implementation 'com.github.pointcheckout:android-sdk:v1.0.0'\n}\n")),(0,r.kt)("h3",{id:"required-permissions"},"Required Permissions"),(0,r.kt)("p",null,"The PointCheckout SDK requires the following permissions. Please add them to your AndroidManifest.xml file if they are not already present:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<uses-permission android:name="android.permission.INTERNET"/>\n')),(0,r.kt)("h3",{id:"adding-safetynet-support"},"Adding SafetyNet Support"),(0,r.kt)("p",null,"Add Google's SafetyNet API to your ",(0,r.kt)("inlineCode",{parentName:"p"},"app/build.gradle"),", follow ",(0,r.kt)("a",{parentName:"p",href:"https://developers.google.com/android/guides/setup"},"this guide"),"."),(0,r.kt)("p",null,"After these steps, rebuild your app and you are good to go!"),(0,r.kt)("h2",{id:"using-the-sdk"},"Using the SDK"),(0,r.kt)("h3",{id:"sequence-diagram"},"Sequence diagram"),(0,r.kt)("p",null,"This diagram shows the overall payment and data flow in order to accept payments using the PointCheckout\nmobile SDK"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Sequence Diagram",src:n(8156).Z})),(0,r.kt)("h3",{id:"server-checkout-request"},"Server Checkout request"),(0,r.kt)("p",null,"Send new checkout request to ",(0,r.kt)("a",{parentName:"p",href:"https://www.pointcheckout.com/en/developers/api/api-integration"},"PointCheckout's API")," using endpoint ",(0,r.kt)("inlineCode",{parentName:"p"},"/mer/v1.2/checkouts")," (check the ",(0,r.kt)("a",{parentName:"p",href:"https://www.pointcheckout.com/en/developers/api/api-integration"},"documentation")," for more details)."),(0,r.kt)("h3",{id:"initializing-pointcheckoutclient"},"Initializing PointCheckoutClient"),(0,r.kt)("p",null,"Create an object of PointCheckoutClient:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"PointCheckoutClient pcClient = new PointCheckoutClient();\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Keep a reference of the created client to reuse the same instance")),(0,r.kt)("h4",{id:"initialize"},"Initialize"),(0,r.kt)("p",null,"Initialize the created ",(0,r.kt)("inlineCode",{parentName:"p"},"PointCheckoutClient")," using:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"pcClient.initialize(context);\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Invoke initialize when the app starts because it needs 2-3 seconds. If the client is not initialized and pay is called, the client will call initialize internally before calling pay.")),(0,r.kt)("h4",{id:"payment-submit"},"Payment submit"),(0,r.kt)("p",null,"To submit a payment call the static ",(0,r.kt)("inlineCode",{parentName:"p"},"pay")," method of the ",(0,r.kt)("inlineCode",{parentName:"p"},"PointCheckoutClient"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'pcClient.pay(context, redirectUrl, resultUrl, new PointCheckoutEventListener() {\n                @Override\n                public void onPaymentCancel() {\n                    System.out.println("!!PAYMENT CANCELLED");\n                }\n\n                @Override\n                public void onPaymentUpdate() {\n                    System.out.println("!!PAYMENT UPDATED");\n                }\n        });\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"context"),(0,r.kt)("td",{parentName:"tr",align:null},"Current activity context")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"redirectUrl"),(0,r.kt)("td",{parentName:"tr",align:null},"This URL is included in the checkout response from PointCheckout API")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"resultUrl"),(0,r.kt)("td",{parentName:"tr",align:null},"The same URL passed to PointCheckout API when creating the checkout")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"listener"),(0,r.kt)("td",{parentName:"tr",align:null},"Listener that will be called on payment update or cancellation")))),(0,r.kt)("p",null,"Calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"pay")," function will open a modal and the user will be able to login and complete the payment."),(0,r.kt)("h4",{id:"pointcheckouteventlistener"},"PointCheckoutEventListener"),(0,r.kt)("p",null,"The event listener has two callbacks, ",(0,r.kt)("inlineCode",{parentName:"p"},"onPaymentCancel")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"onPaymentUpdate"),"."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"onPaymentCancel")," will only be called if the user closes the modal by clicking on close button."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"onPaymentUpdate")," will be called whenever the checkout status is updated (paid, cancelled, failed .etc). When this callback is invoked you should call PointCheckout API to fetch the new status of the checkout."),(0,r.kt)("p",null,"Send new checkout request to ",(0,r.kt)("a",{parentName:"p",href:"https://www.pointcheckout.com/en/developers/api/api-integration"},"PointCheckout's API")," using endpoint ",(0,r.kt)("inlineCode",{parentName:"p"},"/mer/v1.2/checkouts")," (check the ",(0,r.kt)("a",{parentName:"p",href:"https://www.pointcheckout.com/en/developers/api/api-integration"},"documentation")," for more details). The SDK needs two variables:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Variable"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"redirectUrl"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Will be returned in the response body of the checkout request. This is the URL to the payment page of PointCheckout. The SDK accepts only PointCheckout URLs.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"resultUrl"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"This is where you normally redirect the user on payment success or failure, for instance to mark the order as paid on payment success.")))),(0,r.kt)("h3",{id:"create-pointcheckoutclient"},"Create PointCheckoutClient"),(0,r.kt)("p",null,"Create an object of PointCheckoutClient:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"PointCheckoutClient client = new PointCheckoutClient();\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Keep a reference of the created client to reuse the same instance")),(0,r.kt)("h3",{id:"initialize-1"},"Initialize"),(0,r.kt)("p",null,"Initialize the created ",(0,r.kt)("inlineCode",{parentName:"p"},"PointCheckoutClient")," using:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"client.initialize(context);\n")),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Invoke initialize when the app starts because it needs 2-3 seconds. If the client is not initialized and pay is called, the client will call initialize internally before calling pay."))),(0,r.kt)("h3",{id:"payment-submit-1"},"Payment submit"),(0,r.kt)("p",null,"To submit a payment call the static ",(0,r.kt)("inlineCode",{parentName:"p"},"pay")," method of the ",(0,r.kt)("inlineCode",{parentName:"p"},"PointCheckoutClient"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'client.pay(context, redirectUrl, resultUrl, new PointCheckoutEventListener() {\n  @Override\n  public void onPaymentCancel() {\n    System.out.println("!!PAYMENT CANCELLED");\n  }\n  @Override\n  public void onPaymentUpdate() {\n    System.out.println("!!PAYMENT UPDATED");\n  }\n});\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"context"),(0,r.kt)("td",{parentName:"tr",align:null},"Current activity context")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"redirectUrl"),(0,r.kt)("td",{parentName:"tr",align:null},"URL of the payment page, can be obtained from the API")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"resultUrl"),(0,r.kt)("td",{parentName:"tr",align:null},"URL that PointCheckout will call upon payment success or failure")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"listener"),(0,r.kt)("td",{parentName:"tr",align:null},"Listener that will be called on payment update or cancellation")))),(0,r.kt)("p",null,"Calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"pay")," function will open a modal and the user will be able to login and complete the payment."))}s.isMDXComponent=!0},8156:function(e,t,n){"use strict";t.Z=n.p+"assets/images/sdk-flow-c0b29523b0c1176499edfc278f2706ad.png"}}]);